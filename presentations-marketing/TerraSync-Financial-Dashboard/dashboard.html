<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TERRASYNC - Financial Projections Dashboard</title>
    
    <!-- External Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- CSS Styles -->
    <link rel="stylesheet" href="css/dashboard-styles.css">
    
    <style>
        /* Enhanced Assumptions Section Styling */
        .assumptions-container .assumption-card {
            background: rgba(55, 65, 81, 0.6) !important;
            border: 1px solid rgba(75, 85, 99, 0.3) !important;
            border-radius: 12px !important;
            padding: 20px !important;
            transition: transform 0.3s ease !important;
            margin-bottom: 0 !important;
            height: fit-content;
        }
        
        .assumptions-container .assumption-card:hover {
            transform: translateY(-3px) !important;
            box-shadow: 0 8px 25px rgba(34, 197, 94, 0.15) !important;
            border-color: rgba(34, 197, 94, 0.5) !important;
        }
        
        .assumptions-container .assumption-title {
            color: #22c55e !important;
            font-weight: 600 !important;
            margin-bottom: 15px !important;
            font-size: 1.1rem !important;
            border-bottom: 1px solid rgba(75, 85, 99, 0.3) !important;
            padding-bottom: 10px !important;
        }
        
        .assumptions-container .assumption-row {
            display: flex !important;
            justify-content: space-between !important;
            align-items: flex-start !important;
            padding: 10px 0 !important;
            border-bottom: 1px solid rgba(75, 85, 99, 0.1) !important;
        }
        
        .assumptions-container .assumption-row:last-child {
            border-bottom: none !important;
            padding-bottom: 0 !important;
        }
        
        .assumptions-container .assumption-label {
            color: #d1d5db !important;
            font-size: 0.9rem !important;
            font-weight: 500 !important;
            flex: 1 !important;
            line-height: 1.4 !important;
        }
        
        .assumptions-container .assumption-value {
            color: #ffffff !important;
            font-weight: 500 !important;
            text-align: right !important;
            flex: 1 !important;
            line-height: 1.4 !important;
        }
        
        .assumptions-container .assumption-value.positive {
            color: #22c55e !important;
            font-weight: 600 !important;
        }
        
        /* Header styling */
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }
        
        .header-left, .header-right {
            flex: 0 0 200px;
        }
        
        .header-center {
            flex: 1;
            text-align: center;
        }
        
        .back-to-portal {
            background: rgba(31, 41, 55, 0.8);
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: #22c55e;
            padding: 8px 16px;
            border-radius: 8px;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .back-to-portal:hover {
            background: rgba(34, 197, 94, 0.1);
            border-color: #22c55e;
            transform: translateY(-2px);
            color: #22c55e;
            text-decoration: none;
        }

        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .assumptions-container .assumption-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)) !important;
                gap: 15px !important;
            }
        }
        
        @media (max-width: 768px) {
            .assumptions-container .assumption-grid {
                grid-template-columns: 1fr !important;
                gap: 15px !important;
            }
            
            .assumptions-container .assumption-row {
                flex-direction: column !important;
                align-items: flex-start !important;
                gap: 5px !important;
            }
            
            .assumptions-container .assumption-value {
                text-align: left !important;
            }
            
            .header-content {
                flex-direction: column;
                gap: 10px;
            }
            
            .header-left, .header-right {
                flex: none;
            }
        }
    </style>
    
    <script src="js/unified-financial-model.js"></script>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <div class="header-content">
                <div class="header-left">
                    <!-- Space for additional controls -->
                </div>
                <div class="header-center">
                    <h1>TERRASYNC FINANCIAL PROJECTIONS</h1>
                    <p style="color: #9ca3af; font-size: 1.2rem;">Live Financial Model</p>
                </div>
                <div class="header-right">
                    <a href="portal.html" class="back-to-portal">
                        <i class="fas fa-arrow-left"></i>
                        Back to Portal
                    </a>
                </div>
            </div>
        </div>
        



        <!-- FINANCIAL PROJECTIONS -->
        <div id="projections" class="tab-content active">
            <div class="scenario-controls">
                <div class="time-slider-compact">
                    <i class="icon icon-calendar" style="color: #9ca3af; font-size: 0.85rem;"></i>
                    <input type="range" 
                           id="timeSlider" 
                           class="time-slider-small" 
                           min="0" 
                           max="59" 
                           value="0" 
                           oninput="updateMetricsForMonth(this.value)">
                    <span style="color: #22c55e; font-size: 0.9rem; font-weight: 600; min-width: 100px;" id="currentMonthLabel">April 2025</span>
                </div>
            </div>
            
            <div class="dashboard-grid">
                <div class="chart-container">
                    <div class="section-title" style="display: flex; align-items: center; gap: 12px;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color: #22c55e;">
                            <path d="M3 3v18h18M7 12l4-4 4 4 4-4"/>
                        </svg>
                        Growth Trajectory
                    </div>
                    <div class="chart-controls">
                        <button class="chart-btn active" onclick="switchChart('revenue')">Total Revenue</button>
                        <button class="chart-btn" onclick="switchChart('acres')">Acres</button>
                        <button class="chart-btn" onclick="switchChart('locations')">Locations</button>
                    </div>
                    <canvas id="mainChart" width="800" height="400"></canvas>
                </div>
                
                <div class="metrics-panel">
                    <div class="metric-card">
                        <div class="metric-value" id="currentRevenue">$0</div>
                        <div class="metric-label">Monthly Revenue</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-value" id="currentAcres">0</div>
                        <div class="metric-label">Total Acres Managed</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-value" id="currentLocations">0</div>
                        <div class="metric-label">Active Locations</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-value" id="currentCashFlow">$0</div>
                        <div class="metric-label">Monthly Net Cash Flow</div>
                    </div>
                </div>
            </div>
            
            <!-- Investor KPIs Section -->
            <div id="investor-kpis" style="margin-top: 25px; padding: 20px; background: rgba(31, 41, 55, 0.4); border: 1px solid rgba(34, 197, 94, 0.2); border-radius: 12px; box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);">
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 20px;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color: #22c55e;">
                        <path d="M3 3v18h18"/>
                        <path d="M7 16l4-4 4 4 6-6"/>
                        <circle cx="11" cy="12" r="1"/>
                        <circle cx="15" cy="8" r="1"/>
                        <circle cx="21" cy="2" r="1"/>
                    </svg>
                    <h3 style="color: #22c55e; font-size: 1.1rem; font-weight: 600; margin: 0;">Key Annual Metrics</h3>
                    <span style="color: #9ca3af; font-size: 0.85rem; font-style: italic;">Investor KPIs by Year</span>
                </div>
                
                <div id="annual-metrics-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px;">
                    <!-- Metrics will be populated by JavaScript -->
                </div>
            </div>
            
            <!-- Low-profile Pro Forma Access -->
            <div style="margin-top: 25px; padding: 15px 20px; background: rgba(34, 197, 94, 0.08); border-radius: 12px; border: 1px solid rgba(34, 197, 94, 0.2); display: flex; align-items: center; justify-content: space-between;">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color: #22c55e;">
                        <path d="M3 3h18v18H3z"/>
                        <path d="M21 9H3"/>
                        <path d="M21 15H3"/>
                        <path d="M12 3v18"/>
                    </svg>
                    <div>
                        <div style="color: #22c55e; font-size: 1rem; font-weight: 600; margin-bottom: 2px;">Detailed Financial Pro Forma</div>
                        <div style="color: #9ca3af; font-size: 0.85rem;">Complete 60-month projections with quarterly breakdowns</div>
                    </div>
                </div>
                <a href="financial-proforma.html" 
                   style="display: inline-flex; align-items: center; gap: 8px; padding: 10px 16px; 
                          background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); 
                          border-radius: 8px; color: #ffffff; text-decoration: none; 
                          font-size: 0.9rem; font-weight: 600; transition: all 0.2s ease;"
                   onmouseover="this.style.transform='translateY(-2px)'"
                   onmouseout="this.style.transform='translateY(0)'">
                    View Pro Forma
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M7 17l9.2-9.2M17 17V7H7"/>
                    </svg>
                </a>
            </div>
            
            <!-- NEW Financial Model Assumptions Section -->
            <div class="assumptions-container" style="background: rgba(31, 41, 55, 0.4); border: 1px solid rgba(34, 197, 94, 0.2); border-radius: 16px; padding: 25px; margin-top: 25px; box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);">
                <div class="assumptions-header" style="display: flex; align-items: center; gap: 12px; color: #22c55e; font-size: 1.4rem; font-weight: 600; margin-bottom: 20px;">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color: #22c55e;">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15v-2h2v2h-2zm2-4h-2V7h2v6z"/>
                    </svg>
                    Financial Model Assumptions
                </div>
                <div class="assumptions-tabs" style="display: flex; gap: 5px; margin-bottom: 25px; justify-content: center; background: rgba(31, 41, 55, 0.4); border-radius: 12px; padding: 10px; border: 1px solid rgba(34, 197, 94, 0.2);">
                    <button class="assumption-tab-btn active" onclick="switchAssumptionTab('growth')" style="padding: 12px 20px; background: rgba(34, 197, 94, 0.3); border: 2px solid #22c55e; border-radius: 10px; color: #22c55e; cursor: pointer; transition: all 0.3s ease; font-weight: 500; flex: 1; text-align: center; max-width: 200px;">Client & Growth</button>
                    <button class="assumption-tab-btn" onclick="switchAssumptionTab('territory')" style="padding: 12px 20px; background: rgba(55, 65, 81, 0.6); border: 2px solid rgba(75, 85, 99, 0.3); border-radius: 10px; color: #d1d5db; cursor: pointer; transition: all 0.3s ease; font-weight: 500; flex: 1; text-align: center; max-width: 200px;">Territory</button>
                    <button class="assumption-tab-btn" onclick="switchAssumptionTab('revenue')" style="padding: 12px 20px; background: rgba(55, 65, 81, 0.6); border: 2px solid rgba(75, 85, 99, 0.3); border-radius: 10px; color: #d1d5db; cursor: pointer; transition: all 0.3s ease; font-weight: 500; flex: 1; text-align: center; max-width: 200px;">Revenue</button>
                    <button class="assumption-tab-btn" onclick="switchAssumptionTab('costs')" style="padding: 12px 20px; background: rgba(55, 65, 81, 0.6); border: 2px solid rgba(75, 85, 99, 0.3); border-radius: 10px; color: #d1d5db; cursor: pointer; transition: all 0.3s ease; font-weight: 500; flex: 1; text-align: center; max-width: 200px;">Costs</button>
                    <button class="assumption-tab-btn" onclick="switchAssumptionTab('market')" style="padding: 12px 20px; background: rgba(55, 65, 81, 0.6); border: 2px solid rgba(75, 85, 99, 0.3); border-radius: 10px; color: #d1d5db; cursor: pointer; transition: all 0.3s ease; font-weight: 500; flex: 1; text-align: center; max-width: 200px;">Market</button>
                </div>
                
                <div id="growth" class="assumption-content active" style="display: block;">
                    <div class="assumption-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin-bottom: 20px;">
                        <div class="assumption-card">
                            <div class="assumption-title">Client Acquisition Schedule</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Year 1 (2025)</span>
                                <span class="assumption-value">3-7 other clients, 1-3 golf courses per month</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Year 2 (2026)</span>
                                <span class="assumption-value">Golf: 25% monthly, Other: 50% monthly</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Year 3+ (2027)</span>
                                <span class="assumption-value">Golf: 55% monthly, Other: 60% monthly</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Mature Market (2030+)</span>
                                <span class="assumption-value">Golf: 8% monthly, Other: 5% monthly</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Client Mix Evolution</div>
                            <div class="assumption-row">
                                <span class="assumption-label">2025 Focus</span>
                                <span class="assumption-value">30% Golf, 70% Other</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">2026 Balanced</span>
                                <span class="assumption-value">50% Golf, 50% Other</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">2027+ Golf Focus</span>
                                <span class="assumption-value">70-85% Golf, 15-30% Other</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">SaaS Conversion</span>
                                <span class="assumption-value">15-50% convert from service to SaaS</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Client Size & Growth</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Golf Course Range</span>
                                <span class="assumption-value">80-120 acres (start 80-100)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Other Clients Range</span>
                                <span class="assumption-value">5-40 acres (start 5-15)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Golf Maturity Time</span>
                                <span class="assumption-value">36 months to full size</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Other Maturity Time</span>
                                <span class="assumption-value">18 months to full size</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Churn & Retention</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Monthly Churn Rate</span>
                                <span class="assumption-value">0.5% (2025-2027), 0.6-0.7% (2028+)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Min Age for Churn</span>
                                <span class="assumption-value">6 months minimum</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">SaaS Trial Conversion</span>
                                <span class="assumption-value">75% convert from trial to paid</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">SaaS Freemium Adoption</span>
                                <span class="assumption-value">50% start on trial</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Client Acreage Growth Curve</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Golf Course Growth Pattern</span>
                                <span class="assumption-value">Slow start (10%), Accelerate (80%), Plateau (10%)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Other Clients Pattern</span>
                                <span class="assumption-value">More linear growth over 18 months</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Year 1 Annual Growth</span>
                                <span class="assumption-value">30% of potential</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Year 2 Annual Growth</span>
                                <span class="assumption-value positive">40% of potential</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Year 3 Annual Growth</span>
                                <span class="assumption-value">30% of potential (mature)</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="territory" class="assumption-content" style="display: none;">
                    <div class="assumption-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin-bottom: 20px;">
                        <div class="assumption-card">
                            <div class="assumption-title">Territory Expansion Schedule</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Current (Month 0)</span>
                                <span class="assumption-value positive">2 territories (Knoxville + West Palm)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Year 1 (Months 0-11)</span>
                                <span class="assumption-value">NO NEW TERRITORIES - Foundation phase</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Year 2 (Months 12-23)</span>
                                <span class="assumption-value positive">Add 8 territories (total: 10)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Year 3 (Months 24-36)</span>
                                <span class="assumption-value positive">Add 12 territories (total: 22)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Year 4 (Months 37-49)</span>
                                <span class="assumption-value">Add 8 territories (total: 30)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Year 5+ (Month 50+)</span>
                                <span class="assumption-value">Add 2 territories (total: 32)</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Territory Maturity Curve</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Month 1-3</span>
                                <span class="assumption-value">25-75 acres</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Month 6</span>
                                <span class="assumption-value">150 acres</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Month 12</span>
                                <span class="assumption-value positive">400 acres</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Month 24</span>
                                <span class="assumption-value">800 acres</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Month 48 (Mature)</span>
                                <span class="assumption-value positive">1,200 acres max capacity</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Territory Capacity Limits</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Max Golf Courses</span>
                                <span class="assumption-value">60 per territory</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Max Total Acres</span>
                                <span class="assumption-value">1,800 per territory</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">New Market Size</span>
                                <span class="assumption-value">100 potential clients each</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Current Starting Base</span>
                                <span class="assumption-value positive">62 acres (50 Knox + 12 WPB)</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">2025 Foundation Phase</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Growth Rate (2025)</span>
                                <span class="assumption-value">2 acres/month (slow foundation)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Growth Rate (2026+)</span>
                                <span class="assumption-value positive">25 acres/month (normal growth)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Focus Strategy</span>
                                <span class="assumption-value">Perfect operations before expansion</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Real Current State</span>
                                <span class="assumption-value positive">0.27% market penetration</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="revenue" class="assumption-content" style="display: none;">
                    <div class="assumption-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin-bottom: 20px;">
                        <div class="assumption-card">
                            <div class="assumption-title">Core Revenue Streams</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Service (per acre/month)</span>
                                <span class="assumption-value positive">$59</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Installation (per acre)</span>
                                <span class="assumption-value positive">$700</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Product Sale (per acre)</span>
                                <span class="assumption-value positive">$1,700</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Combined One-Time</span>
                                <span class="assumption-value positive">$2,400 per new acre</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">SaaS Pricing Tiers</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Trial (Month 1)</span>
                                <span class="assumption-value">$500</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Small Team (≤4 users)</span>
                                <span class="assumption-value positive">$2,500/month</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Professional (≤10 users)</span>
                                <span class="assumption-value positive">$5,000/month</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Enterprise (≤25 users)</span>
                                <span class="assumption-value positive">$8,000/month</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">SaaS Add-Ons & Features</div>
                            <div class="assumption-row">
                                <span class="assumption-label">AI Features</span>
                                <span class="assumption-value">$2,500/month</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Premium Support</span>
                                <span class="assumption-value">$1,200/month</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">On-Site Support</span>
                                <span class="assumption-value">$2,000 base + $40/acre</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Additional Users</span>
                                <span class="assumption-value">$150/user/month</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">SaaS Growth & Adoption</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Launch Date</span>
                                <span class="assumption-value positive">Month 14 (SaaS revenue starts)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Direct SaaS Acquisition</span>
                                <span class="assumption-value">10-50 new SaaS clients/year</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Product Sales to SaaS</span>
                                <span class="assumption-value">25% buy $5,000 avg products</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Tier Upgrade Rate</span>
                                <span class="assumption-value">15% to Pro, 10% to Enterprise</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Service-to-SaaS Conversion Rates</div>
                            <div class="assumption-row">
                                <span class="assumption-label">2026 Conversion</span>
                                <span class="assumption-value">15% of service clients convert</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">2027 Conversion</span>
                                <span class="assumption-value positive">25% conversion rate</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">2028 Conversion</span>
                                <span class="assumption-value positive">40% conversion rate</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">2029+ Mature Rate</span>
                                <span class="assumption-value positive">50% conversion rate</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Recurring Product Revenue</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Base Purchase Probability</span>
                                <span class="assumption-value">2% per month per client</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Mature Client Bonus</span>
                                <span class="assumption-value">+1% if age > 2 years, +1% if age > 4 years</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Large Client Bonus</span>
                                <span class="assumption-value">+0.5% if >50 acres, +0.5% if >100 acres</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Average Purchase Value</span>
                                <span class="assumption-value">$800 base + $8/acre</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Profit Margins</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Service Margin</span>
                                <span class="assumption-value positive">70%</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Installation Margin</span>
                                <span class="assumption-value">60%</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Product Margin</span>
                                <span class="assumption-value">25%</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">SaaS Margin</span>
                                <span class="assumption-value positive">90%</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="costs" class="assumption-content" style="display: none;">
                    <div class="assumption-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin-bottom: 20px;">
                        <div class="assumption-card">
                            <div class="assumption-title">Starting Team & Salaries</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Field Service Tech</span>
                                <span class="assumption-value">$2,000/month ($24K/year)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Sales Ops</span>
                                <span class="assumption-value">$2,000/month ($24K/year)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Executive Assistant</span>
                                <span class="assumption-value">$2,000/month ($24K/year)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Developer (Month 4)</span>
                                <span class="assumption-value">$2,500/month (3 developers)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Founder Salary</span>
                                <span class="assumption-value">$2,000/month (bootstrap)</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Salary Scaling (ARR-Based)</div>
                            <div class="assumption-row">
                                <span class="assumption-label">At $200K ARR</span>
                                <span class="assumption-value">Tech: $42K, Sales: $48K</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">At $500K ARR</span>
                                <span class="assumption-value positive">Tech: $54K, Sales: $66K, Founder: $72K</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">At $1M ARR</span>
                                <span class="assumption-value positive">Tech: $66K, Sales: $84K</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Developer Schedule</span>
                                <span class="assumption-value">$54K (Month 10), $84K (Month 18)</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Operational Costs</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Rent & Utilities (per location)</span>
                                <span class="assumption-value">$3,000/month</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Support Cost (per client)</span>
                                <span class="assumption-value">$100/month</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Operations (per acre)</span>
                                <span class="assumption-value">$10/month</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">West Palm Commission</span>
                                <span class="assumption-value">40% of (Revenue - OpEx)</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">G&A Costs</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Professional Services</span>
                                <span class="assumption-value">$2,500-$8,000/month (ARR-based)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Business Software</span>
                                <span class="assumption-value">$50/employee/month</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Corporate Insurance</span>
                                <span class="assumption-value">$12K base + $2K/location/year</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">IT Security</span>
                                <span class="assumption-value">$25/employee/month</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Acquisition Costs</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Travel per Client</span>
                                <span class="assumption-value">$4,500 (flights, hotels)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Entertainment per Client</span>
                                <span class="assumption-value">$3,000 (dinners, events)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Sales Commission</span>
                                <span class="assumption-value">10% of first year TCV</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Marketing Budget</span>
                                <span class="assumption-value">$2,500-$12,000/month (growth stage)</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Year-Specific Cost Multipliers</div>
                            <div class="assumption-row">
                                <span class="assumption-label">2025 (Foundation)</span>
                                <span class="assumption-value">Acquisition: 30%, Operational: 60%</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">2026 (Growth)</span>
                                <span class="assumption-value">Acquisition: 120%, Operational: 100%</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">2028+ (Efficient)</span>
                                <span class="assumption-value">Acquisition: 80%, Operational: 95%</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">2029+ (Software Focus)</span>
                                <span class="assumption-value">Acquisition: 50%, Operational: 90%</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Enhanced Territory Cost Model</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Base Cost per Acre</span>
                                <span class="assumption-value">$12/month (dynamic)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Territory Complexity Factor</span>
                                <span class="assumption-value">+5% cost per additional territory</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Tech Maturity Factor</span>
                                <span class="assumption-value">-0.5% cost per month (efficiency gains)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Seasonal Adjustment</span>
                                <span class="assumption-value">0.7x (Dec) to 1.3x (Summer)</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Dynamic Hiring Schedule</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Field Techs Needed</span>
                                <span class="assumption-value">1 per 200 acres</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Developer Hiring</span>
                                <span class="assumption-value positive">3 developers in Month 4</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">New Hire Tech Kit</span>
                                <span class="assumption-value">$2,500 one-time cost</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">IT Security per Employee</span>
                                <span class="assumption-value">$25/month</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="market" class="assumption-content" style="display: none;">
                    <div class="assumption-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin-bottom: 20px;">
                        <div class="assumption-card">
                            <div class="assumption-title">Total Addressable Market</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Total Addressable Acres</span>
                                <span class="assumption-value positive">23,000+ acres</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Current Penetration</span>
                                <span class="assumption-value">0.27% (62 / 23,000)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Growth Potential</span>
                                <span class="assumption-value positive">370x expansion opportunity</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Annual Market Value</span>
                                <span class="assumption-value positive">$16.3M (23,000 × $59 × 12)</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Knoxville Market</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Addressable Acres</span>
                                <span class="assumption-value">3,000+ acres</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Current Acres</span>
                                <span class="assumption-value positive">50 acres</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Current Penetration</span>
                                <span class="assumption-value">1.7% (50 / 3,000)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Annual TAM</span>
                                <span class="assumption-value">$2.1M (3,000 × $59 × 12)</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">West Palm Beach Market</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Addressable Acres</span>
                                <span class="assumption-value positive">20,000+ acres</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Current Acres</span>
                                <span class="assumption-value">12 acres</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Current Penetration</span>
                                <span class="assumption-value">0.06% (12 / 20,000)</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Annual TAM</span>
                                <span class="assumption-value positive">$14.2M (20,000 × $59 × 12)</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Market Segments</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Golf Courses</span>
                                <span class="assumption-value">Primary target - extensive acreage</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Corporate Properties</span>
                                <span class="assumption-value">Office complexes, commercial landscaping</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Municipal Properties</span>
                                <span class="assumption-value">Parks, public spaces, city facilities</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">High-End Residential</span>
                                <span class="assumption-value">Large properties with irrigation needs</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Competitive Landscape</div>
                            <div class="assumption-row">
                                <span class="assumption-label">Market Position</span>
                                <span class="assumption-value positive">First-mover advantage in tech-enabled service</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Unit Economics Validation</span>
                                <span class="assumption-value positive">$59/acre proven and profitable</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Territory Model</span>
                                <span class="assumption-value">Scalable franchise-like approach</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Technology Moat</span>
                                <span class="assumption-value">SaaS platform creates switching costs</span>
                            </div>
                        </div>
                        
                        <div class="assumption-card">
                            <div class="assumption-title">Market Penetration Goals</div>
                            <div class="assumption-row">
                                <span class="assumption-label">5-Year Target</span>
                                <span class="assumption-value positive">5-10% market penetration</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Territory Count Target</span>
                                <span class="assumption-value">32 territories by Year 5</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Revenue at 5% Penetration</span>
                                <span class="assumption-value positive">$815K annual revenue</span>
                            </div>
                            <div class="assumption-row">
                                <span class="assumption-label">Revenue at 10% Penetration</span>
                                <span class="assumption-value positive">$1.6M annual revenue</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </div>
    </div>

    <script>
        let projections = [];
        let mainChart = null;
        
        // Assumptions section toggle functions
        function toggleAssumptions() {
            const content = document.getElementById('assumptions-content');
            const chevron = document.getElementById('assumptions-chevron');
            const toggleText = document.getElementById('assumptions-toggle-text');
            
            if (content.style.display === 'none' || content.style.display === '') {
                content.style.display = 'block';
                chevron.style.transform = 'rotate(180deg)';
                toggleText.textContent = 'Hide Assumptions';
            } else {
                content.style.display = 'none';
                chevron.style.transform = 'rotate(0deg)';
                toggleText.textContent = 'View All Assumptions';
            }
        }
        
        function toggleCategory(categoryId) {
            const content = document.getElementById(categoryId);
            const button = content.previousElementSibling.querySelector('button');
            const chevron = button.querySelector('.category-chevron');
            
            // Toggle the category content
            if (content.style.display === 'none' || content.style.display === '') {
                content.style.display = 'block';
                chevron.style.transform = 'rotate(180deg)';
                button.classList.add('active');
            } else {
                content.style.display = 'none';
                chevron.style.transform = 'rotate(0deg)';
                button.classList.remove('active');
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            try {
                console.log("Initializing financial model...");
                const model = new UnifiedFinancialModel(assumptions);
                projections = model.runSimulation(60);
                console.log("Simulation complete. Projections:", projections);
                console.log("First projection:", projections[0]);
                console.log("First projection revenues:", projections[0]?.revenues);
                console.log("First projection revenue breakdown:", projections[0]?.revenues?.breakdown);
                console.log("Revenue object structure:", Object.keys(projections[0]?.revenues || {}));
                console.log("Sample revenue data:", {
                    total: projections[0]?.revenues?.total,
                    serviceRevenue: projections[0]?.revenues?.breakdown?.serviceRevenue,
                    productRevenue: projections[0]?.revenues?.breakdown?.productRevenue,
                    installationRevenue: projections[0]?.revenues?.breakdown?.installationRevenue,
                    saasRevenue: projections[0]?.revenues?.breakdown?.saasRevenue
                });

                const ctx = document.getElementById('mainChart').getContext('2d');
                mainChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: projections.map(p => {
                            const date = new Date('2025-04-01T00:00:00Z');
                            date.setUTCMonth(date.getUTCMonth() + p.month);
                            return date;
                        }),
                        datasets: []
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                type: 'time',
                                time: { unit: 'month' },
                                ticks: { color: '#9ca3af' },
                                grid: { color: '#374151' }
                            },
                            y: {
                                ticks: { 
                                    color: '#9ca3af',
                                    callback: function(value) {
                                        if (Math.abs(value) >= 1000000)
                                            return '$' + (value / 1000000).toFixed(1) + 'M';
                                        if (Math.abs(value) >= 1000)
                                            return '$' + (value / 1000).toFixed(0) + 'K';
                                        return '$' + value;
                                    }
                                },
                                grid: { color: '#374151' }
                            }
                        },
                        plugins: {
                            legend: { labels: { color: '#e5e7eb' } }
                        }
                    }
                });

                switchChart('revenue');
                updateMetricsForMonth(0);
                updateInvestorKPIs();

            } catch (error) {
                console.error('Failed to initialize dashboard:', error);
                document.body.innerHTML = '<h1 style="color:red; text-align:center; margin-top: 50px;">Error initializing dashboard. Check console.</h1>';
            }
        });

        function switchChart(metric) {
            document.querySelectorAll('.chart-btn').forEach((btn, index) => {
                btn.classList.remove('active');
                if (btn.getAttribute('onclick') === `switchChart('${metric}')`) {
                    btn.classList.add('active');
                }
            });

            switch(metric) {
                case 'revenue':
                    const serviceData = projections.map(p => p.revenues?.breakdown?.serviceRevenue || 0);
                    const productData = projections.map(p => p.revenues?.breakdown?.productRevenue || 0);
                    const installationData = projections.map(p => p.revenues?.breakdown?.installationRevenue || 0);
                    const saasData = projections.map(p => p.revenues?.breakdown?.saasRevenue || 0);
                    
                    const hasBreakdownData = projections[0]?.revenues?.breakdown;
                    
                    if (hasBreakdownData) {
                        mainChart.data.datasets = [
                            {
                                label: 'Service Revenue',
                                data: serviceData,
                                borderColor: '#22c55e',
                                backgroundColor: 'rgba(34, 197, 94, 0.1)',
                                fill: true,
                                tension: 0.4,
                                borderWidth: 3,
                                pointRadius: 2,
                                pointHoverRadius: 6,
                            },
                            {
                                label: 'Product Revenue',
                                data: productData,
                                borderColor: '#3b82f6',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                fill: true,
                                tension: 0.4,
                                borderWidth: 3,
                                pointRadius: 2,
                                pointHoverRadius: 6,
                            },
                            {
                                label: 'Installation Revenue',
                                data: installationData,
                                borderColor: '#f59e0b',
                                backgroundColor: 'rgba(245, 158, 11, 0.1)',
                                fill: true,
                                tension: 0.4,
                                borderWidth: 3,
                                pointRadius: 2,
                                pointHoverRadius: 6,
                            },
                            {
                                label: 'SaaS Revenue',
                                data: saasData,
                                borderColor: '#8b5cf6',
                                backgroundColor: 'rgba(139, 92, 246, 0.1)',
                                fill: true,
                                tension: 0.4,
                                borderWidth: 3,
                                pointRadius: 2,
                                pointHoverRadius: 6,
                            }
                        ];
                    } else {
                        mainChart.data.datasets = [{
                            label: 'Total Revenue',
                            data: projections.map(p => p.revenues?.total || 0),
                            borderColor: '#22c55e',
                            backgroundColor: 'rgba(34, 197, 94, 0.2)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 3,
                        }];
                    }
                    break;
                    
                case 'acres':
                    mainChart.data.datasets = [{
                        label: 'Total Acres Managed',
                        data: projections.map(p => p.totalAcres),
                        borderColor: '#eab308',
                        backgroundColor: 'rgba(234, 179, 8, 0.2)',
                        fill: true,
                        tension: 0.4,
                        borderWidth: 3,
                    }];
                    break;
                    
                case 'locations':
                    mainChart.data.datasets = [{
                        label: 'Active Locations',
                        data: projections.map(p => p.locations),
                        borderColor: '#8b5cf6',
                        backgroundColor: 'rgba(139, 92, 246, 0.2)',
                        fill: true,
                        tension: 0.4,
                        borderWidth: 3,
                    }];
                    break;
            }
            
            mainChart.update();
        }

        function updateMetricsForMonth(monthIndex) {
            const month = Number(monthIndex);
            const data = projections[month];

            const date = new Date('2025-04-01T00:00:00Z');
            date.setUTCMonth(date.getUTCMonth() + month);
            document.getElementById('currentMonthLabel').textContent = date.toLocaleDateString('en-US', { month: 'long', year: 'numeric', timeZone: 'UTC' });

            document.getElementById('currentRevenue').textContent = '$' + Math.round(data.revenues.total).toLocaleString();
            document.getElementById('currentAcres').textContent = Math.round(data.totalAcres).toLocaleString();
            document.getElementById('currentLocations').textContent = data.locations;
            document.getElementById('currentCashFlow').textContent = '$' + Math.round(data.netCashFlow).toLocaleString();
        }

        // Assumptions tab switching functionality
        function switchAssumptionTab(tabName) {
            // Hide all assumption contents
            document.querySelectorAll('.assumption-content').forEach(content => {
                content.classList.remove('active');
                content.style.display = 'none';
            });
            
            // Reset all assumption tab buttons to inactive state
            document.querySelectorAll('.assumption-tab-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.style.background = 'rgba(55, 65, 81, 0.6)';
                btn.style.border = '2px solid rgba(75, 85, 99, 0.3)';
                btn.style.color = '#d1d5db';
            });
            
            // Show selected content
            const selectedContent = document.getElementById(tabName);
            selectedContent.classList.add('active');
            selectedContent.style.display = 'block';
            
            // Set active tab styling
            event.target.classList.add('active');
            event.target.style.background = 'rgba(34, 197, 94, 0.3)';
            event.target.style.border = '2px solid #22c55e';
            event.target.style.color = '#22c55e';
        }

        function updateInvestorKPIs() {
            // Calculate annual aggregated metrics from monthly projections
            const annualData = {};
            
            // Group projections by year and calculate key metrics
            projections.forEach((projection, index) => {
                const year = 2025 + Math.floor(projection.month / 12);
                if (!annualData[year]) {
                    annualData[year] = {
                        year,
                        projections: [],
                        totalRevenue: 0,
                        totalCosts: 0,
                        endingARR: 0,
                        endingClients: 0,
                        endingAcres: 0,
                        endingTeam: 0,
                        totalNewClients: 0,
                        avgMonthlyRevenue: 0
                    };
                }
                annualData[year].projections.push(projection);
            });

            // Calculate metrics for each year
            Object.values(annualData).forEach(yearData => {
                const projections = yearData.projections;
                const lastMonth = projections[projections.length - 1];
                
                // Sum total revenue and costs for the year
                yearData.totalRevenue = projections.reduce((sum, p) => sum + (p.revenues?.total || 0), 0);
                yearData.totalCosts = projections.reduce((sum, p) => sum + (p.costs?.totalCosts || 0), 0);
                yearData.avgMonthlyRevenue = yearData.totalRevenue / projections.length;
                
                // End-of-year metrics
                yearData.endingARR = lastMonth?.cumulativeARR || 0;
                yearData.endingClients = lastMonth?.clients || 0;
                yearData.endingAcres = lastMonth?.totalAcres || 0;
                yearData.endingTeam = lastMonth?.team || lastMonth?.teamCount || 0;
                
                // Calculate new clients acquired in this year
                yearData.totalNewClients = projections.reduce((sum, p) => sum + (p.newClientsAcquired || 0), 0);
            });

            // Generate the investor KPI widgets
            const grid = document.getElementById('annual-metrics-grid');
            const sortedYears = Object.keys(annualData).sort();
            
            let html = '';
            
            sortedYears.forEach((year, index) => {
                const data = annualData[year];
                const prevYear = index > 0 ? annualData[sortedYears[index - 1]] : null;
                
                // Calculate key metrics
                const arr = data.endingARR;
                const revenueGrowth = prevYear ? ((data.totalRevenue - prevYear.totalRevenue) / prevYear.totalRevenue * 100) : 0;
                const grossMargin = data.totalRevenue > 0 ? ((data.totalRevenue - data.totalCosts) / data.totalRevenue * 100) : 0;
                const revenuePerAcre = data.endingAcres > 0 ? (data.avgMonthlyRevenue / data.endingAcres) : 0;
                const clientGrowth = prevYear ? (data.endingClients - prevYear.endingClients) : data.endingClients;
                const teamEfficiency = data.endingTeam > 0 ? (data.endingAcres / data.endingTeam) : 0;
                
                html += `
                    <div style="background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(34, 197, 94, 0.2); border-radius: 8px; padding: 16px; text-align: center; transition: all 0.3s ease; cursor: pointer;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(34, 197, 94, 0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                        <div style="color: #22c55e; font-size: 1.5rem; font-weight: 700; margin-bottom: 4px;">${year}</div>
                        <div style="color: #9ca3af; font-size: 0.8rem; margin-bottom: 8px;">Annual Summary</div>
                        <div style="border-top: 1px solid rgba(34, 197, 94, 0.1); padding-top: 8px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <span style="color: #d1d5db; font-size: 0.75rem;">ARR:</span>
                                <span style="color: #22c55e; font-size: 0.75rem; font-weight: 600;">$${Math.round(arr / 1000)}K</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <span style="color: #d1d5db; font-size: 0.75rem;">Growth:</span>
                                <span style="color: ${revenueGrowth >= 0 ? '#22c55e' : '#ef4444'}; font-size: 0.75rem; font-weight: 600;">${revenueGrowth.toFixed(0)}%</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <span style="color: #d1d5db; font-size: 0.75rem;">Margin:</span>
                                <span style="color: ${grossMargin >= 60 ? '#22c55e' : grossMargin >= 40 ? '#f59e0b' : '#ef4444'}; font-size: 0.75rem; font-weight: 600;">${grossMargin.toFixed(0)}%</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <span style="color: #d1d5db; font-size: 0.75rem;">Rev/Acre:</span>
                                <span style="color: #8b5cf6; font-size: 0.75rem; font-weight: 600;">$${Math.round(revenuePerAcre)}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <span style="color: #d1d5db; font-size: 0.75rem;">Clients:</span>
                                <span style="color: #3b82f6; font-size: 0.75rem; font-weight: 600;">${data.endingClients}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: #d1d5db; font-size: 0.75rem;">Team:</span>
                                <span style="color: #f59e0b; font-size: 0.75rem; font-weight: 600;">${data.endingTeam}</span>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            grid.innerHTML = html;
        }

    </script>
</body>
</html>